{% import "nunjucks-macros.html" as macros %}



<div class="row" style="padding-left: 15px; padding-right: 15px;">
    <div class="col-sm-10 col-sm-offset-1" style="border-style:solid; border-radius: px; border-width: 1px; border-color: rgb(228, 228, 228);   padding: 20px 40px; margin-bottom: 50px; margin-top: 20px;">

        {% if dataType == "int" or dataType == "real" %}

        <ul style="margin-bottom: 10px;">
            <li><b>Count:</b> {{ count }} (number of not null values)</li>
            <li><b>Minimum:</b> {{ min }}</li>
            <li><b>Maximum:</b> {{ max }}</li>
        </ul>

        {% elif dataType == "char" %}

            {% if distinctWords %}

            <ul style="margin-bottom: 10px;">
                <li><b>Count:</b> {{ count }} (number of not null values)</li>
                <li><b>Distinct words:</b></li>
                <ul>
                    {% for word in distinctWords %}
                    <li>
                        {% if word == undefined %}
                            <em style="color: gray;">NULL</em>
                        {% else %}
                            {{ word }}
                        {% endif %}
                        
                    </li>
                    {% endfor %}                
                </ul>
            </ul>

            {% else  %}

            <ul style="margin-bottom: 10px;">
                <li><b>Count:</b> {{ count }} (number of not null values)</li>
                <li><b>Distinct words:</b> too many, sorry! (the column must have at most 12 distinct words to be used in a legend, because the color scales have at most 12 colors)</li>
            </ul>

            {% endif %}

        {% endif %}



        {% if scale != false %}

        <table class="table table-bordered">

            <thead>
                <tr>
                    <th class="text-center">
                        values
                    </th >

                    <th class="text-center">
                        color
                    </th>

                    <th class="text-center">
                        color (hex code)
                    </th>

                </tr>
            </thead>

            <tbody>

                {% for class in scale %}

                <tr>
                    <td class="text-center">
                        {{ class.valueClass[0] }}

                        {% if class.valueClass[0] != class.valueClass[1] %}
                            &ndash; {{ class.valueClass[1] }}
                        {% endif %}

                    </td>

                    <td class="text-center" style="background-color: {{ class.colorHex }}; border: solid 1px rgb(215, 215, 215);">
                        &nbsp;
                    </td>

                    <td class="text-center">
                        {{ class.colorHex }}

                    </td>


                </tr>

                {% endfor %}

            </tbody>

        </table>

        <div class="checkbox">
          <label>
            <input type="checkbox" value="" id="js-invert-colors" {{ "checked" if invertColors }}>
                Invert color ordering
          </label>
        </div>
{#
        <div class="checkbox">
          <label>
            <input type="checkbox" value="" id="js-light-correction" {{ "checked" if lightCorrection }}>
                Automatic lightness correction 
          </label>
        </div>
#}
        <button type="button" style="margin-right: 10px;" class="btn btn-default" id="js-darken-colors">Darken!</button>
        <button type="button" style="margin-right: 10px;" class="btn btn-default" id="js-brighten-colors">Brigthen!</button>
        <button type="button" style="margin-right: 10px;" class="btn btn-default" id="js-saturate-colors">Saturate!</button>
        <button type="button" style="margin-right: 10px;" class="btn btn-default" id="js-desaturate-colors">Desaturate!</button>
   

        <hr>

        <p>Copy-paste the following blocks to the <a target="_blank" href="/pt/tilemill#/project/{{ mapId }}">{{ mapName }}</a> map settings:</p>


        <div class="row">
        
            <div class="col-sm-6">
                <p style="margin-top: 15px; margin-bottom: 0px; ">CartoCSS </p>
            </div>
            <div class="col-sm-6">
                <button type="button" class="pull-right btn btn-default js-select-code" id="code-carto-0">Select this block</button>        
            </div>

            <div class="col-sm-12">
                <pre style="margin-top: 4px;"><code id="js-carto-0" class="language-css">
                    {{ macros.getCartoCode(scale, tableName, columnName, geometryTypePrimitive, dataType) | trim }}
                </code></pre>
            </div>

        </div>


        {% if count < countGeometries %}

        <div class="row">

            <div class="col-sm-12" style="margin-top: 20px;">
                <div class="alert alert-danger">
                    <b>Warning:</b> the shape has {{ countGeometries }} geometries, so there are {{ countGeometries - count }} entries in the "{{ columnName }}" column with null values. The visualization of these entries has to handled separately. Add the following condition in the cartoCSS editor.
                </div>
            </div>

            <div class="col-sm-6">
                <p style="margin-top: 15px; margin-bottom: 0px; ">CartoCSS </p>
            </div>
            <div class="col-sm-6">
                <button type="button" class="pull-right btn btn-default js-select-code" id="code-carto-1">Select this block</button>        
            </div>

            <div class="col-sm-12">
                <pre style="margin-top: 4px;"><code id="js-carto-1" class="language-css">
#{{ tableName }}["{{ columnName }}" = null] {
    // now use the cartoCSS properties to identify null values
    marker-fill: black;  // or line-color, or polygon-fill, etc
}

                </code></pre>
            </div>

        </div>


        {% endif %}

        <div class="form-group" style="margin-top: 25px; margin-bottom: 0;">
           <label style="margin-bottom: 0;">Legend style</label>

           <div class="radio" style="margin-top: 0;">
             <label>
               <input type="radio" name="legend-style" value="horizontal" {{"checked" if legendStyle == "horizontal" }}>
               Horizontal
             </label>
           </div>
           <div class="radio" style="margin-top: -10px;">
             <label>
               <input type="radio" name="legend-style" value="vertical" {{"checked" if legendStyle == "vertical" }}>
               Vertical
             </label>
           </div>
        </div>

        <div class="row">

            <div class="col-sm-6">
                <p style="margin-top: 15px; margin-bottom: 0px; ">HTML for the legend</p>
            </div>
            <div class="col-sm-6">
                <button type="button" class="pull-right btn btn-default js-select-code" id="code-html">Select this block</button>        
            </div>

            <div class="col-sm-12">
                <pre style="margin-top: 4px;"><code class="language-markup">
                    {{ macros.getDefaultLegendHtml(scale, mapName, legendStyle) | trim | escape }}
                </code></pre>
            </div>

        </div>


 

        {% endif %}

    </div>
</div>
